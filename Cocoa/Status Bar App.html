<!doctype html>




<html class="theme-next mist">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Jason, Blog" />





  <link rel="alternate" href="/atom.xml" title="Jason" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="This article introduces how to build status bar app on Mac OS X using Cocoa with Swift. The source code can be downloaded here.
Development environment:

OS X: 10.11.4
XCode: 7.3
Swift: 2.2

After it’">
<meta property="og:type" content="article">
<meta property="og:title" content="Status Bar App">
<meta property="og:url" content="http://en.atjason.com/Cocoa/Status Bar App.html">
<meta property="og:site_name" content="Jason">
<meta property="og:description" content="This article introduces how to build status bar app on Mac OS X using Cocoa with Swift. The source code can be downloaded here.
Development environment:

OS X: 10.11.4
XCode: 7.3
Swift: 2.2

After it’">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Status App.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Application is agent.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Create Menu.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Add Object.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Set Object Class.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Connect Menu.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Connect Menu Controller.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Icon.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Icon_Dark.jpg">
<meta property="og:image" content="http://p.appsites.io/2016-05-14-Indentation.jpg">
<meta property="og:updated_time" content="2016-05-20T09:34:30.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Status Bar App">
<meta name="twitter:description" content="This article introduces how to build status bar app on Mac OS X using Cocoa with Swift. The source code can be downloaded here.
Development environment:

OS X: 10.11.4
XCode: 7.3
Swift: 2.2

After it’">
<meta name="twitter:image" content="http://p.appsites.io/2016-05-14-Status App.jpg">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: 0,
      author: 'Author'
    }
  };
</script>

  <title> Status Bar App | Jason </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-26569268-1', 'auto');
  ga('send', 'pageview');
</script>









  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Jason</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Status Bar App
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">Posted on</span>
            <time itemprop="dateCreated" datetime="2016-04-08T12:56:00+08:00" content="2016-04-08">
              2016-04-08
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Cocoa/" itemprop="url" rel="index">
                    <span itemprop="name">Cocoa</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/Cocoa/Status Bar App.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="Cocoa/Status Bar App.html" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>This article introduces how to build status bar app on Mac OS X using Cocoa with Swift. The source code can be downloaded <a href="https://github.com/atjason/CocoaDemoWithSwift/tree/master/StatusBarApp/StatusBarApp" target="_blank" rel="external">here</a>.</p>
<p>Development environment:</p>
<ul>
<li>OS X: 10.11.4</li>
<li>XCode: 7.3</li>
<li>Swift: 2.2</li>
</ul>
<p>After it’s finished, the app looks like:</p>
<p><img src="http://p.appsites.io/2016-05-14-Status App.jpg" alt=""></p>
<h1 id="How-to-Run-as-Status-Bar-App"><a href="#How-to-Run-as-Status-Bar-App" class="headerlink" title="How to Run as Status Bar App?"></a>How to Run as Status Bar App?</h1><p>In another word, how to make the application not show a dock icon? The key point is to modify the application’s Info.plist file and indicate that it’s an agent. “Agent” is Apple’s term for a background application that doesn’t present a dock icon.<br>Select the project at the top of the project navigator. Open the Info tab at the top of the main editor. Add a new entry of <strong>Application is agent (UIElement)</strong> and set the value of this entry to YES.</p>
<p><img src="http://p.appsites.io/2016-05-14-Application is agent.jpg" alt=""></p>
<a id="more"></a>
<h1 id="How-to-Let-Status-App-Start"><a href="#How-to-Let-Status-App-Start" class="headerlink" title="How to Let Status App Start?"></a>How to Let Status App Start?</h1><p>It’s better don’t write much code in AppDelegate or other single class. To do it, I split main code in these 2 controllers:</p>
<ol>
<li><p>StatusItemController<br>This controller is mainly to ‘start’ the app, i.e., init the status bar item. And also set the menu for status bar item.</p>
</li>
<li><p>StatusMenuController<br>This controller mainly works as the delegate of status bar item’s menu. E.g., implement the actions of menu items.</p>
</li>
</ol>
<p>Then, how to let the app start? Steps:</p>
<ul>
<li>Open ‘MainMenu.xib’.</li>
<li>Create Menu and sub-menus.</li>
</ul>
<p><img src="http://p.appsites.io/2016-05-14-Create Menu.jpg" alt=""></p>
<ul>
<li>Add an Object. Set its class to ‘StatusMenuController’.</li>
</ul>
<p><img src="http://p.appsites.io/2016-05-14-Add Object.jpg" alt=""></p>
<p><img src="http://p.appsites.io/2016-05-14-Set Object Class.jpg" alt=""></p>
<ul>
<li>Add another Object of ‘StatusItemController’.</li>
<li>Connect Menu object to StatusMenuController’s ‘menu’ outlet.</li>
</ul>
<p><img src="http://p.appsites.io/2016-05-14-Connect Menu.jpg" alt=""></p>
<ul>
<li>Connect StatusMenuController to StatusItemController’s ‘menuController’ outlet.</li>
</ul>
<p><img src="http://p.appsites.io/2016-05-14-Connect Menu Controller.jpg" alt=""></p>
<ul>
<li>Open StatusItemController.swift, init the status bar item in ‘awakeFromNib’.<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StatusItemController</span>: <span class="title">NSObject</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> statusItem: <span class="type">NSStatusItem</span>!</span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> menuController: <span class="type">StatusMenuController</span>!  </span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">awakeFromNib</span><span class="params">()</span></span> &#123;</span><br><span class="line">    statusItem = <span class="type">NSStatusBar</span>.systemStatusBar()</span><br><span class="line">      .statusItemWithLength(<span class="type">NSVariableStatusItemLength</span>)</span><br><span class="line">    statusItem.title = <span class="string">"App"</span></span><br><span class="line">    statusItem.highlightMode = <span class="literal">true</span></span><br><span class="line">    statusItem.menu = menuController.menu</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>That’s it. Now the app should be able to correctly start. As you can see, the key point is, app will init the ‘MainMenu.xib’ (as defined in Info.plist &gt; ‘Main nib file base name’), then all the objects in ‘MainMenu.xib” will be created. So, the menu and controllers you added in ‘MainMenu.xib” will be created. Clear?</p>
<p>In this case, the AppDelegate could even keep empty. Cool, right?<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NSApplicationMain</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AppDelegate</span>: <span class="title">NSObject</span>, <span class="title">NSApplicationDelegate</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="How-to-Show-Percent-in-Status-Bar"><a href="#How-to-Show-Percent-in-Status-Bar" class="headerlink" title="How to Show Percent in Status Bar?"></a>How to Show Percent in Status Bar?</h1><p>There’s class of <code>NSProgressIndicator</code>. The fact of it is a view. Thus the problem becomes how to add this view to status bar.</p>
<p>You will find, the <code>NSStatusItem.view</code> is <code>nil</code>, thus you can’t add to its subview. From the API of <code>NSStatusItem</code> we can found, it’s suggested to use <code>NSStatusItem.button</code> to customize. OK, we can add view to subviews of the <code>button</code>.<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// The button that is displayed in the status bar. This is created automatically on the creation of the StatusItem. Behavior customization for the button, such as image, target/action, tooltip, can be set with this property.</span></span><br><span class="line"><span class="meta">@available</span>(<span class="type">OSX</span> <span class="number">10.10</span>, *)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> button: <span class="type">NSStatusBarButton</span>? &#123; <span class="keyword">get</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>That’s not finished. Using this code could show the percent in status bar, but the size of status bar item is incorrect. How to deal with it? To be honest, I didn’t find a good way, but find a walkaround way, i.e., add an <strong>empty</strong> image to the status bar item. And then add <code>NSProgressIndicator</code> to the <code>button</code>. It’s not good, but works. The code is as following:<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> button = statusItem.button &#123;</span><br><span class="line">        <span class="comment">// <span class="doctag">FIXME:</span> it works, but obviously not good.</span></span><br><span class="line">        <span class="keyword">let</span> frame = <span class="type">NSRect</span>(x: <span class="number">6</span>, y: <span class="number">2</span>, width: <span class="number">18</span>, height: <span class="number">18</span>)</span><br><span class="line">        <span class="keyword">let</span> progressIndicator = <span class="type">NSProgressIndicator</span>(frame: frame)</span><br><span class="line">        progressIndicator.style = .<span class="type">SpinningStyle</span></span><br><span class="line">        progressIndicator.indeterminate = <span class="literal">false</span></span><br><span class="line">        progressIndicator.doubleValue = <span class="number">30</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Use empty image to extand the status item's size</span></span><br><span class="line">        statusItem.image = <span class="type">NSImage</span>(named: <span class="string">"EmptyIconImage"</span>)</span><br><span class="line">        button.addSubview(progressIndicator)</span><br><span class="line">  &#125;</span><br><span class="line">``` </span><br><span class="line"><span class="type">And</span> the percent looks like:</span><br><span class="line"></span><br><span class="line">![](http:<span class="comment">//p.appsites.io/2016-05-14-Percent.jpg)</span></span><br><span class="line">![](http:<span class="comment">//p.appsites.io/2016-05-14-Percent_Dark.jpg)</span></span><br><span class="line"></span><br><span class="line"># <span class="type">How</span> to <span class="type">Disable</span> a <span class="type">Menu</span> <span class="type">Item</span>?</span><br><span class="line"><span class="type">It</span> sounds very easy. <span class="type">Just</span> <span class="keyword">set</span> the `<span class="type">NSMenuItem</span>.enabled = <span class="literal">false</span>`. <span class="type">But</span> the fact <span class="keyword">is</span> not. <span class="type">Read</span> the description <span class="keyword">for</span> `<span class="type">NSMenuItem</span>.autoenablesItems`:</span><br><span class="line"></span><br><span class="line">```swift</span><br><span class="line">    <span class="comment">/* Set and get whether the menu autoenables items.  If a menu autoenables items, then calls to -[NSMenuItem setEnabled:] are ignored, and the enabled state is computed via the NSMenuValidation informal protocol below.  Autoenabling is on by default. */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">var</span> autoenablesItems: <span class="type">Bool</span></span><br></pre></td></tr></table></figure></p>
<p>As you can see, <code>NSMenuItem.autoenablesItems</code> is enabled by default. And if it’s enabled, the set of <code>NSMenuItem.enabled</code> property will be ignored. Thus, if you want to manually control the <code>NSMenuItem.enabled</code> property, first disable the <code>NSMenuItem.autoenablesItems</code> property.</p>
<h1 id="How-to-Support-Dark-Mode"><a href="#How-to-Support-Dark-Mode" class="headerlink" title="How to Support Dark Mode?"></a>How to Support Dark Mode?</h1><p>There’re 2 key points needed to support dark mode of OS X.</p>
<ol>
<li>The icon itself should support. To be exactly, the background of the icon should be transparent.</li>
<li>Set the <code>NSMenuItem.image?.template = true</code></li>
</ol>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* The 'template' property is metadata that allows clients to be smarter about image processing.  An image should be marked as a template if it is basic glpyh-like black and white art that is intended to be processed into derived images for use on screen.</span><br><span class="line"> </span><br><span class="line"> NSButtonCell applies effects to images based on the state of the button.  For example, images are shaded darker when the button is pressed.  If a template image is set on a cell, the cell can apply more sophisticated effects.  For example, it may be processed into an image that looks engraved when drawn into a cell whose interiorBackgroundStyle is NSBackgroundStyleRaised, like on a textured button.</span><br><span class="line"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> template: <span class="type">Bool</span></span><br></pre></td></tr></table></figure>
<p>The normal and dark status bar items look like:</p>
<p><img src="http://p.appsites.io/2016-05-14-Icon.jpg" alt=""><br><img src="http://p.appsites.io/2016-05-14-Icon_Dark.jpg" alt=""></p>
<h1 id="How-to-Support-Indentation-Level"><a href="#How-to-Support-Indentation-Level" class="headerlink" title="How to Support Indentation Level?"></a>How to Support Indentation Level?</h1><p>Easy. Just set the <code>NSMenuItem.indentationLevel</code>.</p>
<p><img src="http://p.appsites.io/2016-05-14-Indentation.jpg" alt=""></p>
<h1 id="How-to-Pop-Over"><a href="#How-to-Pop-Over" class="headerlink" title="How to Pop Over?"></a>How to Pop Over?</h1><p>It’s easy to pop over status item. Check the following code:<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> button = statusItem.button &#123;</span><br><span class="line">  popover.showRelativeToRect(button.bounds, ofView: button, preferredEdge: .<span class="type">MinY</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>But it’s hard to pop over menu item, as menu item’s view is nil by default. And then no view or bound to show popover relatively. Ever see some other app like <a href="http://www.clipmenu.com/blog/2014/11/11/clipmenu-1-0-0a1-released/" target="_blank" rel="external">ClipMenu</a> could implement this feature, but hasn’t found how to do it.</p>
<p>Another walkaround is to use <code>NSMenuItem.toolTip</code> to show additional information of a menu item.</p>
<h1 id="What-Left"><a href="#What-Left" class="headerlink" title="What Left?"></a>What Left?</h1><ul>
<li>tag and representedObject</li>
<li>action</li>
</ul>

      
    </div>

    <div>
      
        
      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Cocoa/Outline With Controller.html" rel="next" title="Use NSOutlineView With NSTreeController">
                <i class="fa fa-chevron-left"></i> Use NSOutlineView With NSTreeController
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Cocoa/Storyboard.html" rel="prev" title="Storyboard">
                Storyboard <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://ww3.sinaimg.cn/large/006ghf8igw1f3lxt6lgnsj30lc0jygn8.jpg"
               alt="Jason" />
          <p class="site-author-name" itemprop="name">Jason</p>
          <p class="site-description motion-element" itemprop="description">Digital Nomad, Mac Developer</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/">
              <span class="site-state-item-count">12</span>
              <span class="site-state-item-name">posts</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/atjason" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/hereisjason" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/atjasonzone" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://toolinbox.net/" title="Toolinbox" target="_blank">Toolinbox</a>
                </li>
              
            </ul>
          </div>
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Run-as-Status-Bar-App"><span class="nav-number">1.</span> <span class="nav-text">How to Run as Status Bar App?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Let-Status-App-Start"><span class="nav-number">2.</span> <span class="nav-text">How to Let Status App Start?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Show-Percent-in-Status-Bar"><span class="nav-number">3.</span> <span class="nav-text">How to Show Percent in Status Bar?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Support-Dark-Mode"><span class="nav-number">4.</span> <span class="nav-text">How to Support Dark Mode?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Support-Indentation-Level"><span class="nav-number">5.</span> <span class="nav-text">How to Support Indentation Level?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#How-to-Pop-Over"><span class="nav-number">6.</span> <span class="nav-text">How to Pop Over?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#What-Left"><span class="nav-number">7.</span> <span class="nav-text">What Left?</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2011 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
</div>

<div class="powered-by">
  Powered by <a class="theme-link" href="http://hexo.io">Hexo</a>
</div>

<div class="theme-info">
  Theme -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'atjason';
      var disqus_identifier = 'Cocoa/Status Bar App.html';
      var disqus_title = 'Status Bar App';
      var disqus_url = 'http://en.atjason.com/Cocoa/Status Bar App.html';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        run_disqus_script('embed.js');
      
    </script>
  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';                
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });
                            
                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').mousedown(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>

  

  

  

</body>
</html>
